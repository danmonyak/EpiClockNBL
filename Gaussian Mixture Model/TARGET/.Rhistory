library(knitr)
library(dplyr)
library(ggplot2)
library(tidyr)
IMC01 <- read.csv("IMC01.csv")
IMC13 <- read.csv("IMC13.csv")
IMC14 <- read.csv("IMC14.csv")
IMCENR <- read.csv("IMCENR.csv")
joined = IMC13 %>% full_join(IMC01 %>% select(PATIENT, Q28), by="PATIENT")
joined %>% filter(Q28==2)
#Calculate emesis score per day
IMC14 <- IMC14 |>
rowwise()|>
mutate(
count_nonNA = sum(!is.na(c_across(Q1:Q18))),
emesis =
case_when(
CHECK_N == 1 ~ 0,
count_nonNA == 1 ~5,
count_nonNA == 2 ~10,
count_nonNA >= 3 ~15,
TRUE ~ 0
)
)|>
ungroup() |>
select(PATIENT, STDYDAY, emesis)
# add emesis scores to IMC13
IMC13 = IMC13 %>%
full_join(IMC14, by = c("PATIENT", "STDYDAY"))
IMC13 = IMC13 %>%
mutate(yawning = ifelse(Q1==2,1,0)) %>%
mutate(lacrimation = ifelse(Q2==2,1,0)) %>%
mutate(rhinorrhea = ifelse(Q3==2,1,0)) %>%
mutate(perspiration = ifelse(Q4==2,1,0)) %>%
mutate(tremor = ifelse(Q5==2,3,0)) %>%
mutate(piloerection = ifelse(Q6==2,3,0)) %>%
mutate(restlessness = ifelse(Q7==2,5,0)) %>%
mutate(anorexia = ifelse(
(Q8A==1 | Q8A==2 | Q8B==1 | Q8B==2 | Q8C==1 | Q8C==2),
3,0))
# Pupil dilation: baseline is avg of study day 1 & 2
pupil_baseline = IMC13 %>%
filter(STDYDAY==2 | STDYDAY==1) %>%
select(PATIENT, STDYDAY, Q9) %>%
group_by(PATIENT) %>%
summarise(Q9_baseline = mean(Q9, na.rm = TRUE), .groups = "drop")
IMC13 = IMC13 %>%
left_join(pupil_baseline, by = "PATIENT") %>%
mutate(pupil = pmax(round(10*(Q9-Q9_baseline), digits=0), 0)) # 1 point for each 0.1 mm increase in pupil size
# weight baseline is study day 2.
weight_baseline = IMC13 %>%
filter(STDYDAY==2) %>%
group_by(PATIENT) %>%
select(PATIENT, Q10) %>%
rename(Q10_baseline = Q10)
library(tidyverse)
library(knitr)
library(dplyr)
library(ggplot2)
library(tidyr)
IMC01 <- read.csv("IMC01.csv")
IMC13 <- read.csv("IMC13.csv")
IMC14 <- read.csv("IMC14.csv")
IMCENR <- read.csv("IMCENR.csv")
joined = IMC13 %>% full_join(IMC01 %>% select(PATIENT, Q28), by="PATIENT")
joined %>% filter(Q28==2)
#Calculate emesis score per day
IMC14 <- IMC14 |>
rowwise()|>
mutate(
count_nonNA = sum(!is.na(c_across(Q1:Q18))),
emesis =
case_when(
CHECK_N == 1 ~ 0,
count_nonNA == 1 ~5,
count_nonNA == 2 ~10,
count_nonNA >= 3 ~15,
TRUE ~ 0
)
)|>
ungroup() |>
select(PATIENT, STDYDAY, emesis)
# add emesis scores to IMC13
IMC13 = IMC13 %>%
full_join(IMC14, by = c("PATIENT", "STDYDAY"))
IMC13 = IMC13 %>%
mutate(yawning = ifelse(Q1==2,1,0)) %>%
mutate(lacrimation = ifelse(Q2==2,1,0)) %>%
mutate(rhinorrhea = ifelse(Q3==2,1,0)) %>%
mutate(perspiration = ifelse(Q4==2,1,0)) %>%
mutate(tremor = ifelse(Q5==2,3,0)) %>%
mutate(piloerection = ifelse(Q6==2,3,0)) %>%
mutate(restlessness = ifelse(Q7==2,5,0)) %>%
mutate(anorexia = ifelse(
(Q8A==1 | Q8A==2 | Q8B==1 | Q8B==2 | Q8C==1 | Q8C==2),
3,0))
# Pupil dilation: baseline is avg of study day 1 & 2
pupil_baseline = IMC13 %>%
filter(STDYDAY==2 | STDYDAY==1) %>%
select(PATIENT, STDYDAY, Q9) %>%
group_by(PATIENT) %>%
summarise(Q9_baseline = mean(Q9, na.rm = TRUE), .groups = "drop")
IMC13 = IMC13 %>%
left_join(pupil_baseline, by = "PATIENT") %>%
mutate(pupil = pmax(round(10*(Q9-Q9_baseline), digits=0), 0)) # 1 point for each 0.1 mm increase in pupil size
# weight baseline is study day 2.
weight_baseline = IMC13 %>%
filter(STDYDAY==2) %>%
group_by(PATIENT) %>%
select(PATIENT, Q10) %>%
rename(Q10_baseline = Q10)
IMC13 = IMC13 %>%
left_join(weight_baseline, by = "PATIENT") %>%
mutate(weight = pmax(round(Q10_baseline-Q10, digits=0), 0)) # 1 pt per each lb lost
# temperature: baseline is avg of study day 1 & 2
IMC13 = IMC13 %>% mutate(Q11 = (Q11 - 32) * 5/9) #convert from 째C to 째F
temp_baseline = IMC13 %>%
filter(STDYDAY==2 | STDYDAY==1) %>%
select(PATIENT, STDYDAY, Q11) %>%
group_by(PATIENT) %>%
summarise(Q11_baseline = mean(Q11, na.rm = TRUE), .groups = "drop")
IMC13 = IMC13 %>%
left_join(temp_baseline, by = "PATIENT") %>%
mutate(temp = pmax(round(10*(Q11-Q11_baseline), digits=0), 0)) # 1 point for each 0.1 degree C. rise
# respiratory rate: baseline is avg of study day 1 & 2
resp_baseline = IMC13 %>%
filter(STDYDAY==2 | STDYDAY==1) %>%
select(PATIENT, STDYDAY, Q12RES) %>%
group_by(PATIENT) %>%
summarise(Q12RES_baseline = mean(Q12RES, na.rm = TRUE), .groups = "drop")
IMC13 = IMC13 %>%
left_join(resp_baseline, by = "PATIENT") %>%
mutate(resp = pmax(round(Q12RES-Q12RES_baseline, digits=0), 0)) # 1 point for each respiration per minute increase
# systolic blood pressure: baseline is avg of study day 1 & 2
sysBP_baseline = IMC13 %>%
filter(STDYDAY==2 | STDYDAY==1) %>%
select(PATIENT, STDYDAY, Q12SYS) %>%
group_by(PATIENT) %>%
summarise(Q12SYS_baseline = mean(Q12SYS, na.rm = TRUE), .groups = "drop")
IMC13 = IMC13 %>%
left_join(sysBP_baseline, by = "PATIENT") %>%
mutate(sysBP = pmin(pmax(round(1/2*(Q12SYS-Q12SYS_baseline), digits=0), 0), 15)) # 1 point for each 2 mm Hg. rise (up to 30 mm).
MHOWS = IMC13 %>%
filter(STDYDAY > 2 & STDYDAY < 11) %>% # first 2 days don't count towards score
group_by(PATIENT, STDYDAY) %>%
summarise(MHOWS = sum(yawning + lacrimation + rhinorrhea + perspiration +
tremor + piloerection + restlessness + anorexia +
pupil + weight + temp + resp + sysBP + emesis,
na.rm = TRUE),.groups = 'drop') %>%
right_join(IMCENR %>% select(PATIENT, TREATMNT), by = "PATIENT")
# MHOWS
MHOWS = IMC13 %>%
filter(STDYDAY > 2 & STDYDAY < 11) %>% # first 2 days don't count towards score
group_by(PATIENT, STDYDAY) %>%
summarise(MHOWS = sum(yawning + lacrimation + rhinorrhea + perspiration +
tremor + piloerection + restlessness + anorexia +
pupil + weight + temp + resp + sysBP + emesis,
na.rm = TRUE),.groups = 'drop') %>%
right_join(IMCENR %>% select(PATIENT, TREATMNT), by = "PATIENT")
# MHOWS
IMC13 %>%
filter(STDYDAY > 2 & STDYDAY < 11) %>%  # Exclude first 2 days
select(PATIENT, STDYDAY, yawning, lacrimation, rhinorrhea, perspiration,
tremor, piloerection, restlessness, anorexia, pupil, weight, temp,
resp, sysBP, emesis) %>%
pivot_longer(cols = -c(PATIENT, STDYDAY), names_to = "Symptom", values_to = "Score") %>%
right_join(IMC01 %>% select(PATIENT, Q28), by = "PATIENT") %>%
mutate(treatment = ifelse(Q28 == 1, "Lofexidine", "Placebo")) %>%
select(-Q28) %>%
ggplot(aes(x = STDYDAY, y = Score, color = Symptom, group = Symptom)) +
stat_summary(fun = function(x) mean(x, na.rm = TRUE), geom = "line", size = .5) +
labs(title = "Symptom Scores Over Study Days",
x = "Study Day",
y = "Symptom Score") +
scale_x_continuous(breaks = 1:10) +
theme_minimal() +
theme(legend.position = "right",
text = element_text(size = 12))
ggplot(MHOWS, aes(x = STDYDAY, y = MHOWS, color = TREATMNT, group = TREATMNT)) +
stat_summary(fun = mean, geom = "line", size = 1) +  # lines for mean
stat_summary(fun = mean, geom = "point", size = 2) + # points for mean
stat_summary(fun.data = mean_se, geom = "errorbar", width = 0.3) + # error bars for sem
labs(title = "MHOWS Scores Over Study Days",
x = "Study Day",
y = "MHOWS (mean +/- SEM)") +
scale_x_continuous(breaks = 1:10) +
geom_vline(xintercept = c(3.5, 8.5), linetype = "dashed") +
theme_minimal()
# New Analysis
# 1. Remove Blood Pressure from MHOWS Score
new_MHOWS = IMC13 %>%
filter(STDYDAY > 2 & STDYDAY < 11) %>% # first 2 days don't count towards score
group_by(PATIENT, STDYDAY) %>%
summarise(adjMHOWS = sum(yawning + lacrimation + rhinorrhea + perspiration +
tremor + piloerection + restlessness + anorexia +
pupil + weight + temp + resp + emesis,
na.rm = TRUE),.groups = 'drop') %>%
right_join(IMC01 %>% select(PATIENT, Q28), by = "PATIENT") %>%
mutate(treatment = ifelse(Q28 == 1,"Lofexidine", "Placebo")) %>%
select(-Q28)
# 2.sysBP
sysBP_data <- IMC13 %>%
select(PATIENT,STDYDAY, Q12SYS)
# 3. Join
new_MHOWS <- new_MHOWS %>%
inner_join(sysBP_data, by = c("PATIENT", "STDYDAY"))
new_MHOWS <- new_MHOWS %>%
mutate(treatment = factor(treatment, levels = c("Placebo", "Lofexidine")))
# 4. Model
#model1 <- lm(adjMHOWS ~ treatment + Q12SYS, data = new_MHOWS)
#model2 <- lm(adjMHOWS ~ treatment + Q12SYS + treatment*Q12SYS, data = new_MHOWS)
# 5. Anova
#anova(model1)
#anova(model2)
# New Analysis
# 1. Remove Blood Pressure from MHOWS Score
new_MHOWS = IMC13 %>%
filter(STDYDAY > 2 & STDYDAY < 11) %>% # first 2 days don't count towards score
group_by(PATIENT, STDYDAY) %>%
summarise(adjMHOWS = sum(yawning + lacrimation + rhinorrhea + perspiration +
tremor + piloerection + restlessness + anorexia +
pupil + weight + temp + resp + emesis,
na.rm = TRUE),.groups = 'drop') %>%
right_join(IMC01 %>% select(PATIENT, Q28), by = "PATIENT") %>%
mutate(treatment = ifelse(Q28 == 1,"Lofexidine", "Placebo")) %>%
select(-Q28)
# 2.sysBP
sysBP_data <- IMC13 %>%
select(PATIENT,STDYDAY, Q12SYS)
# 3. Join
new_MHOWS <- new_MHOWS %>%
inner_join(sysBP_data, by = c("PATIENT", "STDYDAY"))
new_MHOWS <- new_MHOWS %>%
mutate(treatment = factor(treatment, levels = c("Placebo", "Lofexidine")))
# 4. Model
#model1 <- lm(adjMHOWS ~ treatment + Q12SYS, data = new_MHOWS)
#model2 <- lm(adjMHOWS ~ treatment + Q12SYS + treatment*Q12SYS, data = new_MHOWS)
# 5. Anova
#anova(model1)
#anova(model2)
ggplot(MHOWS, aes(x = STDYDAY, y = MHOWS, color = TREATMNT, group = TREATMNT)) +
stat_summary(fun = mean, geom = "line", size = 1) +  # lines for mean
stat_summary(fun = mean, geom = "point", size = 2) + # points for mean
stat_summary(fun.data = mean_se, geom = "errorbar", width = 0.3) + # error bars for sem
labs(title = "MHOWS Scores Over Study Days",
x = "Study Day",
y = "MHOWS (mean +/- SEM)") +
scale_x_continuous(breaks = 1:10) +
geom_vline(xintercept = c(3.5, 8.5), linetype = "dashed") +
theme_minimal()
MHOWS |>
group_by(TREATMNT) |>
count(STDYDAY)
View(MHOWS)
View(IMC13)
View(MHOWS)
library(tidyverse)
library(knitr)
library(dplyr)
library(ggplot2)
library(tidyr)
IMC01 <- read.csv("IMC01.csv")
IMC13 <- read.csv("IMC13.csv")
IMC14 <- read.csv("IMC14.csv")
IMCENR <- read.csv("IMCENR.csv")
joined = IMC13 %>% full_join(IMC01 %>% select(PATIENT, Q28), by="PATIENT")
joined %>% filter(Q28==2)
#Calculate emesis score per day
IMC14 <- IMC14 |>
rowwise()|>
mutate(
count_nonNA = sum(!is.na(c_across(Q1:Q18))),
emesis =
case_when(
CHECK_N == 1 ~ 0,
count_nonNA == 1 ~5,
count_nonNA == 2 ~10,
count_nonNA >= 3 ~15,
TRUE ~ 0
)
)|>
ungroup() |>
select(PATIENT, STDYDAY, emesis)
# add emesis scores to IMC13
IMC13 = IMC13 %>%
full_join(IMC14, by = c("PATIENT", "STDYDAY"))
library(tidyverse)
library(knitr)
library(dplyr)
library(ggplot2)
library(tidyr)
IMC01 <- read.csv("IMC01.csv")
IMC13 <- read.csv("IMC13.csv")
IMC14 <- read.csv("IMC14.csv")
IMCENR <- read.csv("IMCENR.csv")
joined = IMC13 %>% full_join(IMC01 %>% select(PATIENT, Q28), by="PATIENT")
joined %>% filter(Q28==2)
#Calculate emesis score per day
IMC14 <- IMC14 |>
rowwise()|>
mutate(
count_nonNA = sum(!is.na(c_across(Q1:Q18))),
emesis =
case_when(
CHECK_N == 1 ~ 0,
count_nonNA == 1 ~5,
count_nonNA == 2 ~10,
count_nonNA >= 3 ~15,
TRUE ~ 0
)
)|>
ungroup() |>
select(PATIENT, STDYDAY, emesis)
# add emesis scores to IMC13
IMC13 = IMC13 %>%
full_join(IMC14, by = c("PATIENT", "STDYDAY"))
View(IMC13)
IMC01 <- read.csv("IMC01.csv")
IMC13 <- read.csv("IMC13.csv")
IMC14 <- read.csv("IMC14.csv")
IMCENR <- read.csv("IMCENR.csv")
View(IMC13)
View(IMC13)
library(tidyverse)
library(knitr)
library(dplyr)
library(ggplot2)
library(tidyr)
IMC01 <- read.csv("IMC01.csv")
IMC13 <- read.csv("IMC13.csv")
IMC14 <- read.csv("IMC14.csv")
IMCENR <- read.csv("IMCENR.csv")
IMC13 <- IMC13 %>%
group_by(PATIENT, STDYDAY) %>%
slice_min(TIME_ADM, with_ties = FALSE) %>%
ungroup()
joined = IMC13 %>% full_join(IMC01 %>% select(PATIENT, Q28), by="PATIENT")
joined %>% filter(Q28==2)
#Calculate emesis score per day
IMC14 <- IMC14 |>
rowwise()|>
mutate(
count_nonNA = sum(!is.na(c_across(Q1:Q18))),
emesis =
case_when(
CHECK_N == 1 ~ 0,
count_nonNA == 1 ~5,
count_nonNA == 2 ~10,
count_nonNA >= 3 ~15,
TRUE ~ 0
)
)|>
ungroup() |>
select(PATIENT, STDYDAY, emesis)
# add emesis scores to IMC13
IMC13 = IMC13 %>%
full_join(IMC14, by = c("PATIENT", "STDYDAY"))
IMC13 = IMC13 %>%
mutate(yawning = ifelse(Q1==2,1,0)) %>%
mutate(lacrimation = ifelse(Q2==2,1,0)) %>%
mutate(rhinorrhea = ifelse(Q3==2,1,0)) %>%
mutate(perspiration = ifelse(Q4==2,1,0)) %>%
mutate(tremor = ifelse(Q5==2,3,0)) %>%
mutate(piloerection = ifelse(Q6==2,3,0)) %>%
mutate(restlessness = ifelse(Q7==2,5,0)) %>%
mutate(anorexia = ifelse(
(Q8A==1 | Q8A==2 | Q8B==1 | Q8B==2 | Q8C==1 | Q8C==2),
3,0))
# Pupil dilation: baseline is avg of study day 1 & 2
pupil_baseline = IMC13 %>%
filter(STDYDAY==2 | STDYDAY==1) %>%
select(PATIENT, STDYDAY, Q9) %>%
group_by(PATIENT) %>%
summarise(Q9_baseline = mean(Q9, na.rm = TRUE), .groups = "drop")
IMC13 = IMC13 %>%
left_join(pupil_baseline, by = "PATIENT") %>%
mutate(pupil = pmax(round(10*(Q9-Q9_baseline), digits=0), 0)) # 1 point for each 0.1 mm increase in pupil size
# weight baseline is study day 2.
weight_baseline = IMC13 %>%
filter(STDYDAY==2) %>%
group_by(PATIENT) %>%
select(PATIENT, Q10) %>%
rename(Q10_baseline = Q10)
IMC13 = IMC13 %>%
left_join(weight_baseline, by = "PATIENT") %>%
mutate(weight = pmax(round(Q10_baseline-Q10, digits=0), 0)) # 1 pt per each lb lost
# temperature: baseline is avg of study day 1 & 2
IMC13 = IMC13 %>% mutate(Q11 = (Q11 - 32) * 5/9) #convert from 째C to 째F
temp_baseline = IMC13 %>%
filter(STDYDAY==2 | STDYDAY==1) %>%
select(PATIENT, STDYDAY, Q11) %>%
group_by(PATIENT) %>%
summarise(Q11_baseline = mean(Q11, na.rm = TRUE), .groups = "drop")
IMC13 = IMC13 %>%
left_join(temp_baseline, by = "PATIENT") %>%
mutate(temp = pmax(round(10*(Q11-Q11_baseline), digits=0), 0)) # 1 point for each 0.1 degree C. rise
# respiratory rate: baseline is avg of study day 1 & 2
resp_baseline = IMC13 %>%
filter(STDYDAY==2 | STDYDAY==1) %>%
select(PATIENT, STDYDAY, Q12RES) %>%
group_by(PATIENT) %>%
summarise(Q12RES_baseline = mean(Q12RES, na.rm = TRUE), .groups = "drop")
IMC13 = IMC13 %>%
left_join(resp_baseline, by = "PATIENT") %>%
mutate(resp = pmax(round(Q12RES-Q12RES_baseline, digits=0), 0)) # 1 point for each respiration per minute increase
# systolic blood pressure: baseline is avg of study day 1 & 2
sysBP_baseline = IMC13 %>%
filter(STDYDAY==2 | STDYDAY==1) %>%
select(PATIENT, STDYDAY, Q12SYS) %>%
group_by(PATIENT) %>%
summarise(Q12SYS_baseline = mean(Q12SYS, na.rm = TRUE), .groups = "drop")
IMC13 = IMC13 %>%
left_join(sysBP_baseline, by = "PATIENT") %>%
mutate(sysBP = pmin(pmax(round(1/2*(Q12SYS-Q12SYS_baseline), digits=0), 0), 15)) # 1 point for each 2 mm Hg. rise (up to 30 mm).
MHOWS = IMC13 %>%
filter(STDYDAY > 2 & STDYDAY < 11) %>% # first 2 days don't count towards score
group_by(PATIENT, STDYDAY) %>%
summarise(MHOWS = sum(yawning + lacrimation + rhinorrhea + perspiration +
tremor + piloerection + restlessness + anorexia +
pupil + weight + temp + resp + sysBP + emesis,
na.rm = TRUE),.groups = 'drop') %>%
right_join(IMCENR %>% select(PATIENT, TREATMNT), by = "PATIENT")
# MHOWS
IMC13 %>%
filter(STDYDAY > 2 & STDYDAY < 11) %>%  # Exclude first 2 days
select(PATIENT, STDYDAY, yawning, lacrimation, rhinorrhea, perspiration,
tremor, piloerection, restlessness, anorexia, pupil, weight, temp,
resp, sysBP, emesis) %>%
pivot_longer(cols = -c(PATIENT, STDYDAY), names_to = "Symptom", values_to = "Score") %>%
right_join(IMC01 %>% select(PATIENT, Q28), by = "PATIENT") %>%
mutate(treatment = ifelse(Q28 == 1, "Lofexidine", "Placebo")) %>%
select(-Q28) %>%
ggplot(aes(x = STDYDAY, y = Score, color = Symptom, group = Symptom)) +
stat_summary(fun = function(x) mean(x, na.rm = TRUE), geom = "line", size = .5) +
labs(title = "Symptom Scores Over Study Days",
x = "Study Day",
y = "Symptom Score") +
scale_x_continuous(breaks = 1:10) +
theme_minimal() +
theme(legend.position = "right",
text = element_text(size = 12))
ggplot(MHOWS, aes(x = STDYDAY, y = MHOWS, color = TREATMNT, group = TREATMNT)) +
stat_summary(fun = mean, geom = "line", size = 1) +  # lines for mean
stat_summary(fun = mean, geom = "point", size = 2) + # points for mean
stat_summary(fun.data = mean_se, geom = "errorbar", width = 0.3) + # error bars for sem
labs(title = "MHOWS Scores Over Study Days",
x = "Study Day",
y = "MHOWS (mean +/- SEM)") +
scale_x_continuous(breaks = 1:10) +
geom_vline(xintercept = c(3.5, 8.5), linetype = "dashed") +
theme_minimal()
MHOWS |>
group_by(TREATMNT) |>
count(STDYDAY)
View(IMC13)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(rstan)
library(dplyr)
library(ggplot2)
library(bayesplot)
rstan_options(auto_write = TRUE)
options(mc.cores = parallel::detectCores())
data <- read.table(paste0(params$cloud_path, params$beta_vals_file),
header = TRUE, sep = "\t")
site_ids <- data[[1]]
tumor_data <- data[,-1]
num_tumors <- ncol(tumor_data)
num_sites <- nrow(tumor_data)
cat("Number of sites:", num_sites, "\n")
cat("Number of tumors:", num_tumors, "\n")
stan_code <- "
data {
int<lower=1> N_data;
array[N_data] real y;
}
parameters {
simplex[3] psi; // Mixture weights sum to 1
real<lower=0,upper=0.5> X; // left peak position
real<lower=1> N; // effective number of alleles
}
transformed parameters {
// Means of the three Gaussian peaks
real mu_left = X;
real mu_right = 1 - X;
real mu_middle = 0.5;
// Variances (p*(1-p)/N) for each peak
real var_left = X*(1-X)/N;
real var_right = X*(1-X)/N;
real var_middle = 0.25/N; // 0.5*(1-0.5)=0.25
// Standard deviations
real sigma_left = sqrt(var_left);
real sigma_right = sqrt(var_right);
real sigma_middle = sqrt(var_middle);
}
model {
psi ~ dirichlet([5.0, 10.0, 5.0]); // quarter half quarter weighting with tuning for variance
X ~ beta(1,4);
N ~ gamma(2, 0.1);
for (n in 1:N_data) {
array[3] real lps;
lps[1] = log(psi[1]) + normal_lpdf(y[n] | mu_left, sigma_left);
lps[2] = log(psi[2]) + normal_lpdf(y[n] | mu_middle, sigma_middle);
lps[3] = log(psi[3]) + normal_lpdf(y[n] | mu_right, sigma_right);
target += log_sum_exp(lps);
}
}
generated quantities {
real phi = -log1m(2 * X) / 2;
}
"
sm <- stan_model(model_code = stan_code)
unlink("TARGET_GMM_STAN_cache", recursive = TRUE)
